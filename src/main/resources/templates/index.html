<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shorts Urls Easily!</title>
    <link rel="shortcut icon" href="imgs/logo1.svg" type="image/x-icon">
    <link rel="stylesheet" href="css/reset.css">
    <link rel="stylesheet" href="css/style.css">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body>

    <main>
        <h1>Insira sua url no campo abaixo</h1>
        <form id="urlForm" action="/shorten-url" th:object="${url}" method="post">
            <input id="insert" type="text" th:field="*{urlOriginal}" placeholder="Insira sua url aqui">
            <div class="group">
                <input type="submit" value="Criar">
                <input type="reset" value="Limpar">
            </div>  
        </form>

        <p id="resultMessage">blabla</p>
        <p id="shortenedUrl">testando</p>
    </main>

    <footer>
        Desenvolvido por Gustavo7327
    </footer>
    

    <script>
        $(document).ready(function() {
            $("#urlForm").submit(function(event) {
                event.preventDefault(); // Prevent default form submission

                var url = $("#urlOriginal").val();

                $.ajax({
                    url: "/shorten-url",
                    type: "POST",
                    data: JSON.stringify({ url: url }), // Send data as JSON
                    contentType: "application/json; charset=utf-8", // Set content type
                    success: function(response) {
                        // Handle successful response
                        $("#shortenedUrl").text("Acesse a URL em: " + response.url); // Update UI with shortened URL
                        $("#resultMessage").text("URL encurtada com sucesso!"); // Display success message
                    },
                    error: function(jqXHR, textStatus, errorThrown) {
                        // Handle errors (optional)
                        console.error("Error shortening URL:", textStatus, errorThrown);
                        $("#resultMessage").text("An error occurred. Please try again."); // Display error message
                    }
                });
            });
        });

    </script>
</body>
</html>